# Process Creation and Shellcode Execution
## Description

This POC demonstrates how to create a new process (in this case, launching an instance of Notepad) and then inject and execute shellcode within that process. Essentially, the code shows a technique often used in malware or penetration testing—code injection—where executable code (shellcode) is written into the memory space of another process and then executed. The POC uses Python’s ctypes library to interface directly with Windows API functions.

## What the POC does
1. Process Creation:
  The code begins by creating a new process (Notepad.exe) using the Windows API call CreateProcessA. In many cases, the process is started in a suspended state (using flags such as CREATE_SUSPENDED), which gives the POC time to inject the shellcode before the process begins normal execution.

2. Memory Allocation in Remote Process:
  Using VirtualAllocEx, the POC allocates a block of memory in the target process (Notepad). This allocated memory will later hold the shellcode. The allocation is done with the combined flags MEM_COMMIT | MEM_RESERVE and initially set to PAGE_READWRITE.

3. Shellcode Injection:
  The shellcode, which is generated via tools like msfvenom, is stored as a byte string in the code. The function WriteProcessMemory writes this shellcode into the allocated memory within the remote process.

4. Changing Memory Protection:
  To allow the shellcode to be executed, the memory protection is changed from PAGE_READWRITE to PAGE_EXECUTE_READ using VirtualProtectEx. This is a critical step because Windows requires memory pages to have execute permissions if they are to be run as code.

5. Executing the Shellcode:
  Instead of directly creating a new thread to execute the shellcode (which is an option using CreateRemoteThread—although it’s commented out here), the POC uses QueueUserAPC (Asynchronous Procedure Call). An APC is queued to the suspended thread, pointing to the shellcode’s address. Finally, ResumeThread is called on the target process’s main thread, which then processes the queued APC and executes the shellcode.

6. Two Variants of Shellcode:
  a. Generic Shellcode: The first part of the code uses shellcode generated by msfvenom.
  
  b. Reverse Shell Payload: Later, the POC demonstrates a variant intended to provide a reverse shell. The reverse shell payload is also generated via msfvenom (with parameters like LHOST and LPORT to define the attacker’s IP and port).


## Prerequisites
1. Install Python from the official website: [python.org](https://www.python.org/downloads/).
2. Create a virtual environment to manage dependencies:
   ```bash
   python -m venv myenv
